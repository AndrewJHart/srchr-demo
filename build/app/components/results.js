define(["app/components/base","text!app/templates/results.html","text!app/templates/result.html"],function(a,b,c){return a({template:b,events:{"click .js-video-filter":function(a){this._filter(a,".video")},"click .js-image-filter":function(a){this._filter(a,".image")},"click .js-twitter-filter":function(a){this._filter(a,".twitter")},"click .js-all-filter":function(a){this._filter(a,"")}},prepare:function(){this.searchData.on("change",_.bind(this._update,this)),this.searchData.on("fetching",_.bind(this._empty,this)),this.itemTpl=_.template(c)},reset:function(){this._filter({currentTarget:this.query(".js-all-filter")},"")},_empty:function(){this.query(".js-results").html("Loading &hellip;")},_filter:function(a,b){$(a.currentTarget).addClass("active").siblings().removeClass("active"),b&&this.query(".result").hide();var c=this.query(".result"+b).show()},_update:function(){var a=this.itemTpl,b={all:0,video:0,image:0,twitter:0},c=this.searchData.map(function(c){console.log("got here");var d=c.get("type"),e=c.toJSON();return b[d]+=1,b.all+=1,e.icon={video:"icon-film",image:"icon-picture",twitter:"icon-user"}[e.type],a(e)}).join("");this.query(".js-results").html(c),_.forEach(["all","video","image","twitter"],_.bind(function(a){this.query(".js-"+a+"-count").html(b[a])},this))}})})