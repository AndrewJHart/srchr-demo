define(["controllers/base","models/app","models/search","collections/searchData","collections/searches","views/results","views/searchForm","views/recentSearches"],function(a,b,c,d,e,f,g,h){return function(){function o(a){var d=$.trim(a),e=i.where({term:d}),f=$.Deferred(),g;return b.set("currentSearch",d),d?(e.length?(g=e[0],g.update()):(g=new c({term:d}),i.add(g)),j.fetch({data:{term:d}}).then(f.resolve,f.reject).always(l.release),b.router.navigate("search/"+d)):f.resolve(),f}var i=new e,j=new d,k=new a({name:"search",update:function(a){return o(a.term)},searches:i,searchData:j,app:b}),l=k.addView(g,{},"#mainbar"),m=k.addView(f,{searchData:j},"#mainbar"),n=k.addView(h,{searches:i,currentSearch:function(){return b.get("currentSearch")}},"#sidebar");return i.fetch(),l.on("search",o),k}})