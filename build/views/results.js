define(["views/base","text!views/templates/results.html","text!views/templates/result.html"],function(a,b,c){return a.extend({template:b,events:{"click .js-video-filter":function(a){this._filter(a,".video")},"click .js-image-filter":function(a){this._filter(a,".image")},"click .js-twitter-filter":function(a){this._filter(a,".twitter")},"click .js-all-filter":function(a){this._filter(a,"")}},prepare:function(){this.bindTo(this.searchData,"add change",this._update),this.bindTo(this.searchData,"fetching",function(){this._empty(),this.reset()}),this.itemTpl=_.template(c)},reset:function(){this._filter({currentTarget:this.$(".js-all-filter")},"")},_empty:function(){this.$(".js-results").html("Loading &hellip;")},_filter:function(a,b){$(a.currentTarget).addClass("active").siblings().removeClass("active"),b&&this.$(".result").hide();var c=this.$(".result"+b).show()},_update:function(){var a=this.itemTpl,b={all:this.searchData.length,video:0,image:0,twitter:0},c=this.searchData.map(function(c){var d=c.get("type"),e=c.toJSON();return b[d]+=1,e.icon={video:"icon-film",image:"icon-picture",twitter:"icon-user"}[e.type],a(e)}).join("");this.$(".js-results").html(c),_.forEach(["all","video","image","twitter"],_.bind(function(a){this.$(".js-"+a+"-count").html(b[a])},this))}})})